https://rustdesk.com/docs/zh-cn/dev/build/windows/


# 安装rust 1.75.0
官网
https://www.rust-lang.org/zh-CN/tools/install
Windows:
    下载rustup-init.exe
Linux/macOS:
    rustup toolchain install 1.60.0
    或
    curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh
查看toolchain
rustup toolchain list
rustup default 1.50.0-x86_64-pc-windows-msvc

# 安装 nightly 工具链
rustup install nightly

# 将默认工具链设置为 nightly
rustup default nightly

# 或者只为当前项目设置 nightly（推荐）
rustup override set nightly

# 编译问题:
    关于stat.mtime() method not found in `Metadata`
    替换为
    use std::time::{SystemTime, UNIX_EPOCH};
    let modified_time = stat.modified().expect("Unable to get modified time");
    let modified_time_since_epoch = modified_time.duration_since(UNIX_EPOCH)
                                    .expect("Time went backwards")
                                    .as_secs() as i64;

安装 vcpkg
cd deps/vcpkg
git clone https://github.com/microsoft/vcpkg
cd vcpkg
git checkout 2023.04.15
cd ..

下载vcpkg.exe
call vcpkg/bootstrap-vcpkg.bat
安装依赖
#windows
vcpkg install libvpx:x64-windows-static libyuv:x64-windows-static opus:x64-windows-static aom:x64-windows-static
或
vcpkg install libvpx:x64-windows-static
vcpkg install libyuv:x64-windows-static
vcpkg install opus:x64-windows-static
vcpkg install aom:x64-windows-static

#linux/macos
vcpkg/bootstrap-vcpkg.sh
export VCPKG_ROOT=$HOME/vcpkg
vcpkg/vcpkg install libvpx libyuv opus aom


#android
vcpkg install libvpx:arm64-windows-static libyuv:arm64-windows-static opus:arm64-windows-static aom:arm64-windows-static libsodium:arm64-windows-static
vcpkg install libvpx:arm64-windows-static
vcpkg install libyuv:arm64-windows-static
vcpkg install opus:arm64-windows-static
vcpkg install aom:arm64-windows-static
vcpkg install libsodium:arm64-windows-static

#mac
#install rust
rustup-init
rustup default 1.75.0
rustup component add rustfmt

brew install python3 create-dmg nasm cmake gcc wget ninja pkg-config wget rustup vpx
vcpkg install libvpx libyuv opus aom
#某些安装可能会失败，因为我们的系统中不存在某些目标文件夹。在这种情况下，请创建文件夹，设置所有者和权限，然后brew再次运行命令。例如，如果/usr/local/include不存在：
sudo mkdir /usr/local/include
sudo chown <username>:admin /usr/local/include
sudo chmod 775 /usr/local/include

cargo install cargo-bundle
pip3 install -r ustdesk/libs/portable/requirements.txt

#flutter
brew tap leoafarias/fvm
brew install fvm cocoapods
fvm global 3.16.9



确保将vcpkg集成到你的MSVC环境中：
vcpkg integrate install

vcpkg_cli probe libvpx
vcpkg list




cargo库缓存目录
C:\Users\mengxingquan\.cargo\registry\src\github.com-1ecc6299db9ec823
cargo install vcpkg_cli
vcpkg_cli probe libvpx:x64-windows-static
mkdir -p target/debug
mv sciter.dll target/debug

windows:
copy "%~dp0/sciter.dll" "%~dp0/target/debug/sciter.dll" /y

build.bat
::vcpkg_cli probe libvpx
::vcpkg list
::构建
cargo build
::运行
::cargo run
::cargo clean
::cargo cache


